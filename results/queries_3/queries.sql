-- Pa√≠s onde o grupo "Harper" mais vendeu

SELECT 
    COUNTRY.COUNTRY_NAME,
    COUNT(ORDER_LINE.BOOK_ID) AS VENDAS
FROM BOOK
    INNER JOIN PUBLISHER ON BOOK.PUBLISHER_ID = PUBLISHER.PUBLISHER_ID
    INNER JOIN ORDER_LINE ON BOOK.BOOK_ID = ORDER_LINE.BOOK_ID
    INNER JOIN CUST_ORDER ON ORDER_LINE.ORDER_ID = CUST_ORDER.ORDER_ID
    INNER JOIN ADDRESS ON CUST_ORDER.DEST_ADDRESS_ID = ADDRESS.ADDRESS_ID
    INNER JOIN COUNTRY ON ADDRESS.COUNTRY_ID = COUNTRY.COUNTRY_ID
WHERE 
    PUBLISHER.PUBLISHER_NAME LIKE '%Harper%'
GROUP BY COUNTRY.COUNTRY_NAME
ORDER BY VENDAS DESC;